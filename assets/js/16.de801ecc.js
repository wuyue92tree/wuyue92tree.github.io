(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{428:function(s,e,a){"use strict";a.r(e);var t=a(12),r=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[s._v("#")]),s._v(" 背景")]),s._v(" "),a("p",[s._v("在使用django rest framework进行接口编写时，使用"),a("code",[s._v("serializers.ModelSerializer")]),s._v("能非常方便快速的生成api接口，面对较为简单的场景时，我们不需要进行过多的定制，但如果接口不仅需要返回"),a("code",[s._v("models")]),s._v("中的字段，还需要返回一些其他的计算结果时，怎么处理呢？")]),s._v(" "),a("h2",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),a("h3",{attrs:{id:"models-py"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#models-py"}},[s._v("#")]),s._v(" models.py")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("from django.db import models\n\nclass Book(models.Models):\n\tname = models.CharField(max_length=255, verbose_name='书名')\n\tdescription = models.TextField(verbose_name='描述')\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"views-py"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#views-py"}},[s._v("#")]),s._v(" views.py")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("from rest_framework import viewsets\nfrom rest_framework import serializers\n\nfrom .models import Book\n\n# 仅展示默认字段\nclass BookSerializers(serializers.ModelSerializer):\n\tclass Meta:\n\t\tmodel = Book\n\t\tfields = '__all__'\n\n# 增加自定义字段\nclass BookSerializers(serializers.ModelSerializer):\n\tbook_sale_count = serializers.SerializerMethodField()\n\tclass Meta:\n\t\tmodel = Book\n\t\tfields = '__all__'\n\n\tdef get_book_sale_count(self, obj):\n\t\t# 这里可以通过obj进行一些处理获取销售量然后返回\n\t\tbook_sale_count = ...\n\t\treturn book_sale_count\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),a("p",[s._v("通过"),a("code",[s._v("serializers.SerializerMethodField")]),s._v("可以实现字段的自定义，但需要注意的是，这个字段是只读的。\n"),a("a",{attrs:{href:"https://www.django-rest-framework.org/community/3.0-announcement/#optional-argument-to-serializermethodfield",target:"_blank",rel:"noopener noreferrer"}},[s._v("更多帮助"),a("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=r.exports}}]);
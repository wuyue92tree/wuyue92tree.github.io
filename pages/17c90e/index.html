<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>在centos7上部署cdh6.3.2 | 资源客栈</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="GO AND BEYOND">
    <link rel="preload" href="/assets/css/0.styles.696438c8.css" as="style"><link rel="preload" href="/assets/js/app.a870adf0.js" as="script"><link rel="preload" href="/assets/js/2.8cb5b17e.js" as="script"><link rel="preload" href="/assets/js/60.fc1fab66.js" as="script"><link rel="prefetch" href="/assets/js/10.3aeabe06.js"><link rel="prefetch" href="/assets/js/11.4cbcbd9d.js"><link rel="prefetch" href="/assets/js/12.4261461c.js"><link rel="prefetch" href="/assets/js/13.4eceefe6.js"><link rel="prefetch" href="/assets/js/14.0c7635ad.js"><link rel="prefetch" href="/assets/js/15.61de4f19.js"><link rel="prefetch" href="/assets/js/16.de801ecc.js"><link rel="prefetch" href="/assets/js/17.4f89c778.js"><link rel="prefetch" href="/assets/js/18.3c5778a7.js"><link rel="prefetch" href="/assets/js/19.eb3b8a6a.js"><link rel="prefetch" href="/assets/js/20.bdaaa403.js"><link rel="prefetch" href="/assets/js/21.009d60ad.js"><link rel="prefetch" href="/assets/js/22.146c7dc9.js"><link rel="prefetch" href="/assets/js/23.75a33d31.js"><link rel="prefetch" href="/assets/js/24.cd874762.js"><link rel="prefetch" href="/assets/js/25.71a9a698.js"><link rel="prefetch" href="/assets/js/26.43108dbd.js"><link rel="prefetch" href="/assets/js/27.b77ebbf4.js"><link rel="prefetch" href="/assets/js/28.5aec0f17.js"><link rel="prefetch" href="/assets/js/29.49461ca3.js"><link rel="prefetch" href="/assets/js/3.35b15324.js"><link rel="prefetch" href="/assets/js/30.528d2155.js"><link rel="prefetch" href="/assets/js/31.28fc852a.js"><link rel="prefetch" href="/assets/js/32.57e86b5c.js"><link rel="prefetch" href="/assets/js/33.103120b9.js"><link rel="prefetch" href="/assets/js/34.71ae33bc.js"><link rel="prefetch" href="/assets/js/35.2ead5d1b.js"><link rel="prefetch" href="/assets/js/36.fd21b995.js"><link rel="prefetch" href="/assets/js/37.ea06fbaa.js"><link rel="prefetch" href="/assets/js/38.9439ff58.js"><link rel="prefetch" href="/assets/js/39.aabecc99.js"><link rel="prefetch" href="/assets/js/4.5e700901.js"><link rel="prefetch" href="/assets/js/40.61b037a3.js"><link rel="prefetch" href="/assets/js/41.11a0c8d5.js"><link rel="prefetch" href="/assets/js/42.fe83be43.js"><link rel="prefetch" href="/assets/js/43.4afd9142.js"><link rel="prefetch" href="/assets/js/44.d2fc5c17.js"><link rel="prefetch" href="/assets/js/45.b90f7893.js"><link rel="prefetch" href="/assets/js/46.8a684ee9.js"><link rel="prefetch" href="/assets/js/47.d09afd14.js"><link rel="prefetch" href="/assets/js/48.ccc5997f.js"><link rel="prefetch" href="/assets/js/49.0bdbb547.js"><link rel="prefetch" href="/assets/js/5.3ae2ba50.js"><link rel="prefetch" href="/assets/js/50.56b63d2d.js"><link rel="prefetch" href="/assets/js/51.d78a0a6c.js"><link rel="prefetch" href="/assets/js/52.404c4a2c.js"><link rel="prefetch" href="/assets/js/53.dc578042.js"><link rel="prefetch" href="/assets/js/54.ea6d195d.js"><link rel="prefetch" href="/assets/js/55.f13b0a22.js"><link rel="prefetch" href="/assets/js/56.ba1700bf.js"><link rel="prefetch" href="/assets/js/57.2e0fdf3f.js"><link rel="prefetch" href="/assets/js/58.f7839aa0.js"><link rel="prefetch" href="/assets/js/59.eb067ede.js"><link rel="prefetch" href="/assets/js/6.c5f8be63.js"><link rel="prefetch" href="/assets/js/61.7847aec8.js"><link rel="prefetch" href="/assets/js/62.b3941b2d.js"><link rel="prefetch" href="/assets/js/63.c6e66541.js"><link rel="prefetch" href="/assets/js/64.fd4f7091.js"><link rel="prefetch" href="/assets/js/65.1ea76be0.js"><link rel="prefetch" href="/assets/js/66.c99cb93b.js"><link rel="prefetch" href="/assets/js/67.ceacc996.js"><link rel="prefetch" href="/assets/js/68.b620b8f1.js"><link rel="prefetch" href="/assets/js/69.27feffbf.js"><link rel="prefetch" href="/assets/js/7.487605d3.js"><link rel="prefetch" href="/assets/js/70.883a98b8.js"><link rel="prefetch" href="/assets/js/71.3dde4be7.js"><link rel="prefetch" href="/assets/js/72.8aa742cd.js"><link rel="prefetch" href="/assets/js/73.1289946c.js"><link rel="prefetch" href="/assets/js/74.5568a47d.js"><link rel="prefetch" href="/assets/js/75.3bfbe16e.js"><link rel="prefetch" href="/assets/js/76.ae60dc52.js"><link rel="prefetch" href="/assets/js/77.01c5c399.js"><link rel="prefetch" href="/assets/js/8.d678c2b6.js"><link rel="prefetch" href="/assets/js/9.dde1e46a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.696438c8.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">资源客栈</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/technology/" class="nav-link">技术专栏</a></div><div class="nav-item"><a href="/collector/" class="nav-link">收藏家</a></div><div class="nav-item"><a href="/opensource/" class="nav-link">开源项目</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/wuyue92tree" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="./img/avatar.png"> <div class="blogger-info"><h3>Yue.Wu</h3> <span>GO AND BEYOND</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/technology/" class="nav-link">技术专栏</a></div><div class="nav-item"><a href="/collector/" class="nav-link">收藏家</a></div><div class="nav-item"><a href="/opensource/" class="nav-link">开源项目</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/wuyue92tree" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>在centos7上部署cdh6.3.2</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/17c90e/#cm" class="sidebar-link">CM</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#cdh" class="sidebar-link">CDH</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#mysql-connector" class="sidebar-link">mysql-connector</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#获取cm-通过yum" class="sidebar-link">获取CM(通过yum)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#安装cm-server-or-agent" class="sidebar-link">安装CM server or agent</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#修改hash文件名称-重要-否则会重新通过网络下载" class="sidebar-link">修改hash文件名称（重要，否则会重新通过网络下载）</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#然后修改目录权限" class="sidebar-link">然后修改目录权限</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#启动服务" class="sidebar-link">启动服务</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#访问服务" class="sidebar-link">访问服务</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#初始化" class="sidebar-link">初始化</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#欢迎界面" class="sidebar-link">欢迎界面</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#设置集群名称" class="sidebar-link">设置集群名称</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#将主机加入集群-通过hosts文件进行搜索" class="sidebar-link">将主机加入集群（通过hosts文件进行搜索）</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#选择存储库" class="sidebar-link">选择存储库</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#jdk安装选项" class="sidebar-link">JDK安装选项</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#提供ssh登录凭证-建议使用root用户" class="sidebar-link">提供SSH登录凭证（建议使用root用户）</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#安装agents" class="sidebar-link">安装Agents</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#安装parcels" class="sidebar-link">安装Parcels</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#检查集群状态" class="sidebar-link">检查集群状态</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#ntpd服务开机启动失败" class="sidebar-link">ntpd服务开机启动失败</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#cdh环境hdfs权限问题" class="sidebar-link">CDH环境HDFS权限问题</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/17c90e/#yarn异常" class="sidebar-link">yarn异常</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-33863c7e><div class="articleInfo" data-v-33863c7e><!----> <div class="info" data-v-33863c7e><div title="作者" class="author iconfont icon-touxiang" data-v-33863c7e><a href="https://github.com/wuyue92tree" target="_blank" title="作者" class="beLink" data-v-33863c7e>Yue.Wu</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-33863c7e><a href="javascript:;" data-v-33863c7e>2020-03-12</a></div> <div title="分类" class="date iconfont icon-wenjian" data-v-33863c7e><a href="/categories/?category=%E5%A4%A7%E6%95%B0%E6%8D%AE" data-v-33863c7e>大数据 </a></div></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">
          在centos7上部署cdh6.3.2
        </h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="系统信息"><a href="#系统信息" class="header-anchor">#</a> 系统信息</h1> <ul><li>操作系统：centos 7.7</li> <li>架构：x86_64</li> <li>数据库：mysql 5.7</li> <li>CM版本：<code>v6.3.1</code></li> <li>CDH版本：<code>v6.3.2</code></li></ul> <h2 id="cm"><a href="#cm" class="header-anchor">#</a> CM</h2> <blockquote><p>下载地址：https://archive.cloudera.com/cm6/6.3.1/redhat7/yum/RPMS/x86_64/</p></blockquote> <ul><li>cloudera-manager-agent-6.3.1-1466458.el7.x86_64.rpm</li> <li>cloudera-manager-daemons-6.3.1-1466458.el7.x86_64.rpm</li> <li>cloudera-manager-server-6.3.1-1466458.el7.x86_64.rpm</li> <li>oracle-j2sdk1.8-1.8.0+update181-1.x86_64.rpm</li></ul> <h2 id="cdh"><a href="#cdh" class="header-anchor">#</a> CDH</h2> <blockquote><p>下载地址：https://archive.cloudera.com/cdh6/6.3.2/parcels/</p></blockquote> <ul><li>CDH-6.3.2-1.cdh6.3.2.p0.1605554-el7.parcel</li> <li>CDH-6.3.2-1.cdh6.3.2.p0.1605554-el7.parcel.sha1</li></ul> <h2 id="mysql-connector"><a href="#mysql-connector" class="header-anchor">#</a> mysql-connector</h2> <blockquote><p>下载地址：https://cdn.mysql.com/archives/mysql-connector-java-5.1/mysql-connector-java-5.1.46.tar.gz</p></blockquote> <ul><li>mysql-connector-java-5.1.46.tar.gz</li></ul> <h1 id="设置时区"><a href="#设置时区" class="header-anchor">#</a> 设置时区</h1> <div class="language- line-numbers-mode"><pre class="language-text"><code>sudo timedatectl set-timezone Asia/Shanghai
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h1 id="节点说明"><a href="#节点说明" class="header-anchor">#</a> 节点说明</h1> <div class="language- line-numbers-mode"><pre class="language-text"><code>192.168.1.81  主节点 CM server &amp; Agent &amp; mysql
192.168.1.82  从节点 CM Agent
192.168.1.83  从节点 CM Agent
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h1 id="主机hosts配置"><a href="#主机hosts配置" class="header-anchor">#</a> 主机hosts配置</h1> <div class="language- line-numbers-mode"><pre class="language-text"><code># sudo vi /etc/hosts
192.168.1.81  cdh-01
192.168.1.82  cdh-02
192.168.1.83  cdh-03
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h1 id="安装jdk-1-8-0"><a href="#安装jdk-1-8-0" class="header-anchor">#</a> 安装jdk 1.8.0</h1> <div class="language- line-numbers-mode"><pre class="language-text"><code>sudo rpm -ivh oracle-j2sdk1.8-1.8.0+update181-1.x86_64.rpm


export JAVA_HOME=/usr/java/jdk1.8.0_181-cloudera
export PATH=$JAVA_HOME/bin:$PATH
export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h1 id="部署mysql-connector"><a href="#部署mysql-connector" class="header-anchor">#</a> 部署mysql-connector</h1> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar -xvf mysql-connector-java-5.1.46.tar.gz
sudo mkdir /usr/share/java
sudo cp mysql-connector-java-5.1.46/mysql-connector-java-5.1.46.jar /usr/share/java/mysql-connector-java.jar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h1 id="关闭防火墙"><a href="#关闭防火墙" class="header-anchor">#</a> 关闭防火墙</h1> <div class="language- line-numbers-mode"><pre class="language-text"><code>sudo systemctl stop firewalld
sudo systemctl disable firewalld
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h1 id="关闭selinux"><a href="#关闭selinux" class="header-anchor">#</a> 关闭selinux</h1> <div class="language- line-numbers-mode"><pre class="language-text"><code># sudo vi /etc/sysconfig/selinux
SELINUX=disabled
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h1 id=""><a href="#" class="header-anchor">#</a></h1> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo 10 &gt; /proc/sys/vm/swappiness
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h1 id="禁用透明大页面压缩"><a href="#禁用透明大页面压缩" class="header-anchor">#</a> 禁用透明大页面压缩</h1> <div class="language- line-numbers-mode"><pre class="language-text"><code># vi /etc/rc.local

echo never &gt; /sys/kernel/mm/transparent_hugepage/defrag
echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h1 id="设置免密登录"><a href="#设置免密登录" class="header-anchor">#</a> 设置免密登录</h1> <div class="language- line-numbers-mode"><pre class="language-text"><code># 在cdh-01上
ssh-keygen
ssh-copy-id cdh-02
ssh-copy-id cdh-03

# 在cdh-02上
ssh-keygen
ssh-copy-id cdh-01
ssh-copy-id cdh-03

# 在cdh-03上
ssh-keygen
ssh-copy-id cdh-01
ssh-copy-id cdh-02
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h1 id="配置ntp时间同步"><a href="#配置ntp时间同步" class="header-anchor">#</a> 配置ntp时间同步</h1> <div class="language- line-numbers-mode"><pre class="language-text"><code>sudo vi /etc/ntp.conf

#注释掉所有server *.*.*的指向，新添加一条可连接的ntp服务器  我使用的是阿里云的NTP服务器
server ntp1.aliyun.com iburst
#在其他节点上把ntp指向master服务器地址即可
server 192.168.1.81 iburst
#安装完成后设置ntp开机启动并启动ntp
sudo systemctl enable ntpd
sudo systemctl start ntpd
#查看状态
sudo systemctl status ntpd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h1 id="安装cm"><a href="#安装cm" class="header-anchor">#</a> 安装CM</h1> <h2 id="获取cm-通过yum"><a href="#获取cm-通过yum" class="header-anchor">#</a> 获取CM(通过yum)</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>sudo wget https://archive.cloudera.com/cm6/6.3.1/redhat7/yum/cloudera-manager.repo -P /etc/yum.repos.d/
sudo rpm --import https://archive.cloudera.com/cm6/6.3.1/redhat7/yum/RPM-GPG-KEY-cloudera
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="安装cm-server-or-agent"><a href="#安装cm-server-or-agent" class="header-anchor">#</a> 安装CM server or agent</h2> <p>建议离线安装，国内下载比较慢，事先通过迅雷下载好安装包。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 将安装包上传到目标服务器，在安装包目录执行安装即可

# 主节点通过 yum 安装
sudo yum install -y cloudera-manager-daemons-6.3.1-1466458.el7.x86_64.rpm
sudo yum install -y cloudera-manager-agent-6.3.1-1466458.el7.x86_64.rpm
sudo yum install -y cloudera-manager-server-6.3.1-1466458.el7.x86_64.rpm

# 从节点通过 yum 安装
sudo yum install -y cloudera-manager-daemons-6.3.1-1466458.el7.x86_64.rpm
sudo yum install -y cloudera-manager-agent-6.3.1-1466458.el7.x86_64.rpm
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h1 id="上传cdh"><a href="#上传cdh" class="header-anchor">#</a> 上传CDH</h1> <p>执行完CM安装之后，主节点上会生成<code>/opt/cloudera/parcel-repo</code>目录，我们需要把下载好的<code>parcel</code>包及hash验证文件上传</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># CDH-6.3.2-1.cdh6.3.2.p0.1605554-el7.parcel
# CDH-6.3.2-1.cdh6.3.2.p0.1605554-el7.parcel.sha1
# 将上面两个文件上传到`/opt/cloudera/parcel-repo`目录
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="修改hash文件名称-重要-否则会重新通过网络下载"><a href="#修改hash文件名称-重要-否则会重新通过网络下载" class="header-anchor">#</a> 修改hash文件名称（重要，否则会重新通过网络下载）</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>cp CDH-6.3.2-1.cdh6.3.2.p0.1605554-el7.parcel.sha1 CDH-6.3.2-1.cdh6.3.2.p0.1605554-el7.parcel.sha
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="然后修改目录权限"><a href="#然后修改目录权限" class="header-anchor">#</a> 然后修改目录权限</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>chown -R cloudera-scm:cloudera-scm /opt/cloudera/parcel-repo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h1 id="创建数据库及数据表"><a href="#创建数据库及数据表" class="header-anchor">#</a> 创建数据库及数据表</h1> <div class="language- line-numbers-mode"><pre class="language-text"><code>CREATE DATABASE scm DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;
GRANT ALL ON scm.* TO 'scm'@'%' IDENTIFIED BY 'cdh123';
CREATE DATABASE amon DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;
GRANT ALL ON amon.* TO 'amon'@'%' IDENTIFIED BY 'cdh123';
CREATE DATABASE rman DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;
GRANT ALL ON rman.* TO 'rman'@'%' IDENTIFIED BY 'cdh123';
CREATE DATABASE hue DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;
GRANT ALL ON hue.* TO 'hue'@'%' IDENTIFIED BY 'cdh123';
CREATE DATABASE metastore DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;
GRANT ALL ON metastore.* TO 'hive'@'%' IDENTIFIED BY 'cdh123';
CREATE DATABASE sentry DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;
GRANT ALL ON sentry.* TO 'sentry'@'%' IDENTIFIED BY 'cdh123';
CREATE DATABASE nav DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;
GRANT ALL ON nav.* TO 'nav'@'%' IDENTIFIED BY 'cdh123';
CREATE DATABASE navms DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;
GRANT ALL ON navms.* TO 'navms'@'%' IDENTIFIED BY 'cdh123';
CREATE DATABASE oozie DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;
GRANT ALL ON oozie.* TO 'oozie'@'%' IDENTIFIED BY 'cdh123';
CREATE DATABASE hive DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;
GRANT ALL ON hive.* TO 'hive'@'%' IDENTIFIED BY 'cdh123';
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h1 id="服务初始化"><a href="#服务初始化" class="header-anchor">#</a> 服务初始化</h1> <h1 id="指定cm数据库"><a href="#指定cm数据库" class="header-anchor">#</a> 指定cm数据库</h1> <div class="language- line-numbers-mode"><pre class="language-text"><code>sudo /opt/cloudera/cm/schema/scm_prepare_database.sh -h &lt;mysql-server&gt; mysql scm scm
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="启动服务"><a href="#启动服务" class="header-anchor">#</a> 启动服务</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code># 主节点执行
sudo systemctl start cloudera-scm-server
sudo systemctl enable cloudera-scm-server
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="访问服务"><a href="#访问服务" class="header-anchor">#</a> 访问服务</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://&lt;主节点IP&gt;:7180/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="初始化"><a href="#初始化" class="header-anchor">#</a> 初始化</h2> <h2 id="欢迎界面"><a href="#欢迎界面" class="header-anchor">#</a> 欢迎界面</h2> <p><img src="https://gitee.com/wuyue92tree/oss/raw/master/blog/i7cRSH.jpg" alt=""></p> <h2 id="设置集群名称"><a href="#设置集群名称" class="header-anchor">#</a> 设置集群名称</h2> <p><img src="https://gitee.com/wuyue92tree/oss/raw/master/blog/PSsw9r.jpg" alt=""></p> <h2 id="将主机加入集群-通过hosts文件进行搜索"><a href="#将主机加入集群-通过hosts文件进行搜索" class="header-anchor">#</a> 将主机加入集群（通过hosts文件进行搜索）</h2> <p><img src="https://gitee.com/wuyue92tree/oss/raw/master/blog/WyJBXz.jpg" alt=""></p> <h2 id="选择存储库"><a href="#选择存储库" class="header-anchor">#</a> 选择存储库</h2> <p><img src="https://gitee.com/wuyue92tree/oss/raw/master/blog/8eb5BO.jpg" alt=""></p> <h2 id="jdk安装选项"><a href="#jdk安装选项" class="header-anchor">#</a> JDK安装选项</h2> <p>这里需要注意的是，由于我们之前已经手动安装了jdk，所以这里不再勾选，否则软件会自动重新联网安装jdk</p> <p><img src="https://gitee.com/wuyue92tree/oss/raw/master/blog/iimce8.jpg" alt=""></p> <h2 id="提供ssh登录凭证-建议使用root用户"><a href="#提供ssh登录凭证-建议使用root用户" class="header-anchor">#</a> 提供SSH登录凭证（建议使用root用户）</h2> <p>尽量使用root用户，否则容易出现一些权限问题
<img src="https://gitee.com/wuyue92tree/oss/raw/master/blog/aZ1Pqe.jpg" alt=""></p> <h2 id="安装agents"><a href="#安装agents" class="header-anchor">#</a> 安装Agents</h2> <p><img src="https://gitee.com/wuyue92tree/oss/raw/master/blog/sR92yW.jpg" alt=""></p> <h2 id="安装parcels"><a href="#安装parcels" class="header-anchor">#</a> 安装Parcels</h2> <p>跳转到这个页面时，需要注意的是，我们之前已经手工上传过<code>Parcels</code>软件包，所以这里应该会直接显示已下载，如果软件仍然联网下载，则需检查之前 <code>上传CDH</code> 步骤是否正确处理了。
<img src="https://gitee.com/wuyue92tree/oss/raw/master/blog/ZdOzhB.jpg" alt=""></p> <h2 id="检查集群状态"><a href="#检查集群状态" class="header-anchor">#</a> 检查集群状态</h2> <p>至此基本就安装完成了，接下来就可以安装服务了。</p> <p><img src="https://gitee.com/wuyue92tree/oss/raw/master/blog/XN0hLl.jpg" alt=""></p> <h1 id="问题解决"><a href="#问题解决" class="header-anchor">#</a> 问题解决</h1> <p>如果初始化过程中出现了一些错误，导致初始化过程没有正常完成，也不要慌张。直接访问管理页面首页<code>http://&lt;主节点IP&gt;:7180/cmf/home</code>，解决问题即可。
<img src="https://gitee.com/wuyue92tree/oss/raw/master/blog/QIZGyT.jpg" alt=""></p> <h1 id="服务安装"><a href="#服务安装" class="header-anchor">#</a> 服务安装</h1> <p><img src="https://gitee.com/wuyue92tree/oss/raw/master/blog/YVBud2.jpg" alt=""></p> <h1 id="faq"><a href="#faq" class="header-anchor">#</a> FAQ</h1> <h2 id="ntpd服务开机启动失败"><a href="#ntpd服务开机启动失败" class="header-anchor">#</a> ntpd服务开机启动失败</h2> <p>与同类型服务chronyd冲突导致启动失败，解决办法是禁用chronyd。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>sudo systemctl disable chronyd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="cdh环境hdfs权限问题"><a href="#cdh环境hdfs权限问题" class="header-anchor">#</a> CDH环境HDFS权限问题</h2> <p>如下，CDH默认的超级用户组为supergroup，而linux中默认是没有这个用户组的，所以在使用非<code>hdfs</code>用户进行hdfs操作时会出现权限不足的问题。</p> <p><img src="https://gitee.com/wuyue92tree/oss/raw/master/blog/u4Q2Cu.png" alt=""></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>sudo groupadd supergroup
sudo usermod -a -G supergroup root
sudo usermod -a -G supergroup centos
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="yarn异常"><a href="#yarn异常" class="header-anchor">#</a> yarn异常</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>org.apache.tez.dag.api.SessionNotRunning: TezSession has already shutdown. Application application_1583310390862_0002 failed 2 times due to AM Container for appattempt_1583310390862_0002_000002 exited with  exitCode: -1000
Failing this attempt.Diagnostics: [2020-03-04 16:30:26.881]org.apache.hadoop.yarn.exceptions.YarnException: Download and unpack failed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>解决方案</p> <p><img src="https://gitee.com/wuyue92tree/oss/raw/master/blog/8KH21f.png" alt=""></p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/wuyue92tree/edit/master/docs/_posts/36.在centos7上部署cdh632.md" target="_blank" rel="noopener noreferrer">帮我改善此页面</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=cdh" title="标签">#cdh</a><a href="/tags/?tag=hadoop" title="标签">#hadoop</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/02/04, 06:30:19</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/a3a305/"><div>docker-compose部署openldap</div></a> <span>12-30</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/9b2797/"><div>drf中如何设置返回Serializers自定义字段</div></a> <span>10-10</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/4c7c71/"><div>在admin中list_display如何展示外键字段</div></a> <span>10-10</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2017-2021
    <span>Yue.Wu | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.a870adf0.js" defer></script><script src="/assets/js/2.8cb5b17e.js" defer></script><script src="/assets/js/60.fc1fab66.js" defer></script>
  </body>
</html>